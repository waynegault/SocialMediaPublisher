# =============================================================================
# Social Media Publisher - Environment Configuration Example
# =============================================================================
# Copy this file to .env and fill in your actual values.
# Lines with "your_..._here" or empty values MUST be configured.
# Prompt templates have sensible defaults — customize to your needs.

# ============================= API KEYS =====================================
GEMINI_API_KEY=your_gemini_api_key_here
OPENAI_API_KEY=your_openai_api_key_here
HUGGINGFACE_API_KEY=your_huggingface_api_key_here
# Alternative name (either works)
# HUGGINGFACE_API_TOKEN=
HF_PREFER_IF_CONFIGURED=True

# =========================== LINKEDIN =======================================
LINKEDIN_USERNAME=your_linkedin_email_here
LINKEDIN_PASSWORD=your_linkedin_password_here
LINKEDIN_AUTHOR_URN=urn:li:person:your_urn_here
LINKEDIN_AUTHOR_NAME=Your Name
LINKEDIN_ORGANIZATION_URN=
LINKEDIN_ACCESS_TOKEN=your_linkedin_access_token_here
LINKEDIN_API_VERSION=202501
LINKEDIN_SEARCH_ENABLED=true
# OAuth 2.0 app credentials (for programmatic token refresh)
LINKEDIN_CLIENT_ID=your_client_id_here
LINKEDIN_CLIENT_SECRET=your_client_secret_here
LINKEDIN_REFRESH_TOKEN=your_refresh_token_here
# Voyager API cookies (extracted from browser dev tools)
LINKEDIN_LI_AT=
LINKEDIN_JSESSIONID=
SKIP_LINKEDIN_DIRECT_SEARCH=True
# LinkedIn engagement limits (anti-automation safety)
LINKEDIN_DAILY_COMMENT_LIMIT=25
LINKEDIN_HOURLY_COMMENT_LIMIT=5
LINKEDIN_MIN_COMMENT_INTERVAL=300
LINKEDIN_DAILY_CONNECTION_LIMIT=20
LINKEDIN_WEEKLY_CONNECTION_LIMIT=100
# LinkedIn post formatting
LINKEDIN_MAX_HASHTAGS=5
LINKEDIN_POST_MAX_CHARS=3000
LINKEDIN_POST_MIN_CHARS=100
LINKEDIN_POST_OPTIMAL_CHARS=1500
# RapidAPI (Fresh LinkedIn Data)
RAPIDAPI_KEY=

# ======================== PROFESSIONAL DISCIPLINE ===========================
DISCIPLINE=chemical engineer

# ============================ LLM PROVIDERS =================================
# Active provider: gemini, groq, local, openai, claude, deepseek, kimi
LLM_PROVIDER=gemini
# Local LLM (LM Studio)
PREFER_LOCAL_LLM=False
LM_STUDIO_BASE_URL=http://localhost:1234/v1
LM_STUDIO_MODEL=local-model
# Groq API (Free Cloud LLM)
GROQ_API_KEY=your_groq_api_key_here
GROQ_MODEL=llama-3.3-70b-versatile
PREFER_GROQ=False
# OpenAI (text generation model, uses OPENAI_API_KEY above)
OPENAI_TEXT_MODEL=gpt-4o-mini
# Anthropic (Claude)
ANTHROPIC_API_KEY=your_anthropic_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514
# DeepSeek
DEEPSEEK_API_KEY=your_deepseek_api_key_here
DEEPSEEK_MODEL=deepseek-chat
# Moonshot AI (Kimi K2)
MOONSHOT_API_KEY=your_moonshot_api_key_here
MOONSHOT_MODEL=kimi-k2
# AI Models
MODEL_TEXT=gemini-2.0-flash
MODEL_VERIFICATION=gemini-2.0-flash
MODEL_IMAGE=imagen-4.0-generate-001
LLM_LOCAL_TIMEOUT=120
LLM_MAX_OUTPUT_TOKENS=8192

# ========================== SEARCH SETTINGS =================================
SEARCH_PROVIDER=duckduckgo
SEARCH_ENGINE=duckduckgo
BROWSER_BACKEND=nodriver
SEARCH_LOOKBACK_DAYS=7
USE_LAST_CHECKED_DATE=True
SEARCH_CYCLE_HOURS=24
MAX_STORIES_PER_SEARCH=1
MAX_PEOPLE_PER_STORY=3
DUCKDUCKGO_MAX_RESULTS=10
SEARCH_PREVIEW_MODE=True
# Optional: override the default search prompt template
# SEARCH_PROMPT_TEMPLATE=

# Optional prompt overrides (empty = use built-in defaults)
# INDIVIDUAL_EXTRACTION_PROMPT=
# LINKEDIN_MENTION_PROMPT=
# LINKEDIN_PROFILE_SEARCH_PROMPT=

# ========================= CONTENT SETTINGS =================================
SUMMARY_WORD_COUNT=200
MIN_QUALITY_SCORE=8

# ========================== DEDUPLICATION ====================================
DEDUP_SIMILARITY_THRESHOLD=0.7
DEDUP_ALL_STORIES_WINDOW_DAYS=90
DEDUP_PUBLISHED_WINDOW_DAYS=30

# ====================== LINKEDIN PROFILE REQUIREMENT ========================
REQUIRE_LINKEDIN_PROFILES=False
MIN_LINKEDIN_PROFILES=1

# ========================= URL VALIDATION ====================================
VALIDATE_SOURCE_URLS=True

# ======================== API RETRY SETTINGS =================================
API_RETRY_COUNT=3
API_RETRY_DELAY=1.0
API_TIMEOUT_DEFAULT=30

# ======================= PUBLICATION SETTINGS ================================
MAX_STORIES_PER_DAY=3
START_PUB_TIME=08:00
END_PUB_TIME=20:00
JITTER_MINUTES=30
PUBLISHER_CHECK_INTERVAL_SECONDS=600

# ============================ CLEANUP ========================================
EXCLUSION_PERIOD_DAYS=30
ARCHIVE_SOURCE_URLS=False

# ======================== CONTENT OPTIONS ====================================
INCLUDE_OPPORTUNITY_MESSAGE=True

# ========================= SIGNATURE BLOCK ===================================
SIGNATURE_BLOCK_DETAIL=MEng Chemical and Process Engineering

# ============================= STORAGE =======================================
DB_NAME=content_engine.db
IMAGE_DIR=generated_images

# ======================== IMAGE GENERATION ===================================
HUMAN_IN_IMAGE=True
# Provider: pollinations, huggingface, z_image, cloudflare, ai_horde,
#           google_imagen, openai_dalle
IMAGE_PROVIDER=huggingface
IMAGE_MODEL=black-forest-labs/FLUX.1-schnell
IMAGE_SIZE=768x512
IMAGE_ASPECT_RATIO=16:9
IMAGE_TIMEOUT_SECONDS=120
IMAGE_REGEN_CUTOFF_DAYS=14
HF_TTI_MODEL=black-forest-labs/FLUX.1-schnell
HF_INFERENCE_ENDPOINT=
AI_HORDE_API_KEY=anonymous

# ====================== CLOUDFLARE WORKERS AI ================================
CLOUDFLARE_ACCOUNT_ID=your_cloudflare_account_id_here
CLOUDFLARE_API_TOKEN=your_cloudflare_api_token_here

# =================== Z-IMAGE LOCAL GENERATION ================================
# Optimized for RTX 3050 Ti (4GB VRAM) with sequential CPU offloading.
# Requires: pip install diffusers accelerate sentencepiece
Z_IMAGE_STEPS=20
Z_IMAGE_GUIDANCE=4.0
Z_IMAGE_DEVICE=cuda
Z_IMAGE_OFFLOAD=sequential
Z_IMAGE_DTYPE=bfloat16
Z_IMAGE_SIZE=512x512
Z_IMAGE_NEGATIVE_PROMPT=text, watermark, logo, blurry, low quality, artifacts, deformed, disfigured, extra limbs, bad anatomy, jpeg artifacts, oversaturated, underexposed, noise, grain
Z_IMAGE_QUANTIZE=0

# ===================== PYTORCH / CUDA RUNTIME ================================
# These are read by PyTorch and HuggingFace libraries directly (not our code)
PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:512,expandable_segments:True
TOKENIZERS_PARALLELISM=false

# ====================== SOURCE & QUALITY SETTINGS ============================
SOURCE_VERIFICATION_ENABLED=True
MIN_SOURCES_REQUIRED=1
MIN_SOURCE_CREDIBILITY=0.3
REQUIRE_TIER1_OR_2_SOURCE=False
ORIGINALITY_CHECK_ENABLED=True
ORIGINALITY_MAX_NGRAM_OVERLAP=0.4
ORIGINALITY_MAX_SIMILARITY=0.6
QUALITY_WEIGHT_RELEVANCE=1.0
QUALITY_WEIGHT_SOURCE=1.0
QUALITY_WEIGHT_RECENCY=1.0
QUALITY_WEIGHT_PEOPLE_MENTIONED=0.5
QUALITY_WEIGHT_GEOGRAPHIC=0.5
QUALITY_MAX_CALIBRATION_BONUS=2

# ========================== PROMPT TEMPLATES =================================
# AI pipeline prompts. Placeholders like {discipline} are filled at runtime.
# Use {{ and }} for literal braces in JSON examples.
# Multi-line values are wrapped in double quotes; use \" for literal quotes.

SEARCH_PROMPT="latest {discipline} news: breakthroughs, research findings, industry developments, regulatory changes, and notable projects suitable for LinkedIn"

SEARCH_INSTRUCTION_PROMPT="You are an expert {discipline_title} news curator with high editorial standards.

TASK: Find up to {max_stories} noteworthy stories matching: {search_prompt}

REQUIREMENTS:
1. Stories must be DIRECTLY relevant to {discipline} professional practice
2. Must be from reputable sources (major publications, research institutions, industry news)
3. Must have verifiable facts and specific technical details
4. No speculation, opinion pieces, or tangentially related content
5. Must be published after {since_date}
6. Each story must cover a DISTINCT topic — no overlapping or duplicate stories

For EACH story, provide:
- title: Clear, factual headline (do not editorialize or add hype)
- summary: Approximately {summary_words} words. Write as {author_name}, a {discipline} professional sharing their perspective on LinkedIn: use first-person ('I'), provide professional insight and analysis, explain why this matters to the field. Do NOT just restate the headline.
- sources: Array of source article URLs
- quality_score: 1-10 rating (be strict: 7=solid relevance, 8=strong, 9=excellent, 10=exceptional)
- quality_justification: 1-2 sentences explaining WHY this score (REQUIRED)
- category: One of [Research, Industry, Career, Technology, Policy]
- organizations: Array of REAL companies, institutions, or research bodies mentioned (NOT generic terms like 'market', 'technology', 'DIY', country names, product names, or topic descriptions)
- direct_people: Array of people mentioned with name, position, company

QUALITY STANDARDS:
- Only include stories scoring 7+
- Reject content only tangentially related to {discipline}
- Prefer stories with real-world impact, technical depth, or professional significance

Return ONLY a valid JSON array. No markdown, no explanation, no wrapper text."

LOCAL_LLM_SEARCH_PROMPT="You are a strict news curator for a {discipline} professional. Analyze these search results and extract ONLY highly relevant stories.

SEARCH RESULTS:
{search_results}

TASK: Select up to {max_stories} stories that are DIRECTLY relevant to {discipline} professional work for LinkedIn publication.
Each story must cover a DISTINCT topic — no overlapping or duplicate stories.

RELEVANCE CRITERIA (be strict):
- Story must be about {discipline} processes, techniques, research, or industry developments
- Tangentially related stories (e.g., logistics, shipping, business deals) should be scored LOW or excluded
- Prefer stories with technical depth, research findings, or professional insights

For each story, provide:
- title: Clear, factual headline (do not editorialize)
- summary: Approximately {summary_words} words, first-person narrative starting with 'I' providing professional insight and analysis, NOT just restating the headline
- source_links: Array of source URLs
- quality_score: 1-10 rating (be harsh: 7-8 = good, 9-10 = exceptional only)
- quality_justification: 1-2 sentences explaining WHY this score (REQUIRED)
- organizations: Array of REAL companies, institutions, or research bodies mentioned (NOT generic terms like 'market', 'technology', 'DIY', country names, product names, or topic descriptions)
- category: One of [Research, Industry, Career, Technology, Policy]

Return ONLY a valid JSON array, no markdown or explanation:
[{{"title": "...", "summary": "...", "source_links": ["..."], "organizations": ["Acme Corp"], "quality_score": 7, "quality_justification": "Directly relevant to {discipline} because...", "category": "Research"}}]"

SEARCH_DISTILL_PROMPT="You are a search query optimizer. Extract 3-6 concise search keywords from the user's conversational query. Return ONLY the keywords as a short phrase, no explanations or formatting. Example: 'chemical engineering breakthroughs 2024' NOT 'Here are the keywords:...'"

IMAGE_STYLE="professional editorial photography for a trade publication, sharp focus on equipment, processes, and technical detail, authentic workplace setting with real tools, instruments, and materials, appropriate safety gear and professional attire for the setting, natural workplace lighting, photorealistic, high editorial quality"

IMAGE_REFINEMENT_PROMPT="Create a single, detailed image-generation prompt for this story.

Story title: {story_title}
Story summary: {story_summary}

Style guidance: {image_style}

RULES:
1. Output ONLY the image prompt — no preamble, no commentary, no quotes.
2. Start the prompt with 'A photo of' for photorealistic output.
3. Describe a SPECIFIC scene that illustrates this particular story, not a generic workplace.
4. Include concrete visual details: specific equipment, materials, environment, and actions.
5. Include the central human character whose appearance is specified earlier in this prompt.
6. End with lighting and camera directions (e.g., 'shot with 85mm lens, natural light').
7. Keep the prompt under 120 words."

IMAGE_REFINEMENT_PROMPT_NO_HUMAN="Create a single, detailed image-generation prompt for this story.

Story title: {story_title}
Story summary: {story_summary}

Style guidance: {image_style}

RULES:
1. Output ONLY the image prompt — no preamble, no commentary, no quotes.
2. Start the prompt with 'A photo of' for photorealistic output.
3. Describe a SPECIFIC scene that illustrates this particular story, not a generic workplace.
4. Include concrete visual details: specific equipment, materials, environment, and actions.
5. Do NOT include any person as the central subject (see instructions above).
6. End with lighting and camera directions (e.g., 'wide-angle lens, natural light').
7. Keep the prompt under 120 words."

IMAGE_FALLBACK_PROMPT="A photo of {appearance} {discipline} professional in an authentic workplace actively engaged with the subject matter of: {story_title}. Face clearly visible with a confident, warm expression. Relevant tools, equipment, or technical environment in the background. Natural workplace lighting, photorealistic, editorial quality for a professional publication."

VERIFICATION_PROMPT="You are a quality reviewer verifying content for LinkedIn publication.

STORY TO EVALUATE:
Title: {story_title}
Summary: {story_summary}
Summary word count: {summary_word_count} (target: ~{summary_word_limit})
Quality justification: {quality_justification}
Sources: {story_sources}
Discipline: {discipline}
Search criteria: {search_prompt}

REJECTION CRITERIA — reject ONLY if a serious issue applies:
1. RELEVANCE: Must be relevant to {discipline} professional practice. Reject stories only tangentially connected.
2. SUBSTANCE: Summary must provide professional insight, not merely restate the headline.
3. QUALITY JUSTIFICATION: Missing justification signals poor curation — reject.
4. TONE: Should read as a credible LinkedIn post — no clickbait, no excessive hype, no promotional language.
5. SUMMARY LENGTH: Ideal range is {min_summary_words}-{max_summary_words} words. Only reject if extremely short (under {min_summary_words} words) or excessively padded/repetitive. Longer summaries with genuine substance are FINE.

IMPORTANT: Do NOT reject solely because the summary exceeds the word target. LinkedIn posts benefit from thorough analysis. Only reject for word count if the extra length is filler or repetition.

RESPONSE FORMAT (plain text only — no JSON, no markdown):
Line 1: APPROVED or REJECTED
Line 2+: A clear explanation of your decision — which criteria passed or failed, and why. Be specific about the content, not generic.

Be strict on relevance and substance. Be lenient on length."

STORY_ENRICHMENT_PROMPT="Extract organizations and people from this news story.

Title: {story_title}
Summary: {story_summary}
Sources: {story_sources}

Look for:
- Company/organization names mentioned
- People quoted or mentioned by name with their titles

Return ONLY valid JSON (no markdown, no explanation):
{{\"organizations\": [\"Org Name\"], \"direct_people\": [{{\"name\": \"Full Name\", \"title\": \"Job Title\", \"affiliation\": \"Organization\"}}]}}

If nothing found, return: {{\"organizations\": [], \"direct_people\": []}}"

INDIRECT_PEOPLE_PROMPT="Find 1-3 senior leaders at {organization_name} relevant to this story.
Story category: {story_category}
Story title: {story_title}

Return ONLY valid JSON (no markdown, no explanation):
{{\"leaders\": [{{\"name\": \"Full Name\", \"title\": \"Job Title\", \"organization\": \"{organization_name}\", \"role_type\": \"executive|academic|pr_comms\", \"location\": \"City, Country\"}}]}}

If you cannot find specific leaders, return: {{\"leaders\": []}}"

COMPANY_MENTION_PROMPT="Given this story, generate a brief company mention sentence.

Title: {story_title}
Summary: {story_summary}
Sources: {story_sources}

If companies are mentioned, return a single sentence mentioning them.
If no companies are mentioned, return: NO_COMPANY_MENTION"

# =================== NEGATIVE PROMPTS (image generation) =====================
HF_NEGATIVE_PROMPT=text, watermark, logo, blurry, low quality, artifacts, jpeg artifacts, nsfw
IMAGE_NEGATIVE_PROMPT=text, words, letters, numbers, labels, signs, writing, captions, titles, watermark, logo, blurry, low quality, artifacts, jpeg artifacts, cartoon, illustration, anime, drawing, painting, sketch, abstract, deformed, distorted, disfigured, bad anatomy, unrealistic proportions, stock photo watermark, grainy, out of focus, overexposed, underexposed

# ===================== ADDITIONAL PROMPT TEMPLATES ===========================
# These prompts were previously hardcoded in the source files.
# Placeholders like {discipline}, {story_title}, etc. are filled at runtime.

PROMOTION_MESSAGE_PROMPT="Generate a DIRECT, ACTION-ORIENTED job-seeking message for LinkedIn that connects to this specific story.

STORY:
Title: {title}
Summary: {summary}

YOUR GOAL: You are a {discipline} actively seeking employment. This message must:
1. Directly connect YOUR job search to the SPECIFIC technology/topic in this story
2. Make it crystal clear you are ACTIVELY JOB HUNTING (use phrases like \"actively seeking\", \"job hunting\", \"interviewing\", \"looking for roles\")
3. Include a DIRECT call-to-action asking people to help (tag hiring managers, DM you, connect, refer you)

REQUIREMENTS:
1. Write in FIRST PERSON (\"I\", \"my\", \"I'm\")
2. MUST reference the specific technology, company, or topic from THIS story (not generic)
3. {credential_instruction}
4. MUST include ONE polite, first-person call-to-action:
   - \"I'd really appreciate it if you could tag a hiring manager!\"
   - \"Please feel free to DM me if you're hiring!\"
   - \"I'd welcome introductions to recruiters in this space!\"
   - \"If you know of any openings, I'd love to hear from you!\"
   - \"I'd be grateful for any connections to people hiring in this field!\"
5. Sound confident and eager, NOT passive or note-like
6. Keep it to 1-2 punchy sentences, max 250 characters
7. No emojis

BAD EXAMPLES (too passive/vague - DO NOT write like this):
- \"Interesting developments in the field.\" (no job ask)
- \"This is relevant to my background.\" (no CTA)
- \"I find this topic fascinating.\" (sounds like a note)

GOOD EXAMPLES (direct job-seeking with clear CTA):
{examples_text}

OUTPUT: Write ONLY the promotion message, nothing else."

SOURCE_URL_LOOKUP_PROMPT="Find the original news article URL for this story. Return ONLY the URL, nothing else.

Story: {title}

Summary: {summary}"

JSON_REPAIR_PROMPT="Fix this malformed JSON and return ONLY the corrected JSON array, no explanation:

{malformed_json}"

ORG_URN_LOOKUP_PROMPT="Find the LinkedIn organization ID for: {url}

I need the numeric organization ID (also called company ID) for this LinkedIn page.
The slug is: {org_slug}

Search for information about this LinkedIn {org_type} page's numeric ID.
The ID is typically a number like 1234567 or similar.

RESPONSE FORMAT:
If you find the organization ID, respond with just the number:
12345678

If you cannot find it, respond with:
NOT_FOUND"

COMPANY_SEARCH_PROMPT="Find the official LinkedIn page for: {company_name}

Search for: {search_query}

TASK: Find the MAIN LinkedIn company or school page URL.

IMPORTANT RULES:
1. Find the MAIN/OFFICIAL page for the whole organization, NOT a department or subsidiary
2. For universities, look for the main university page, not individual departments
3. The URL must be linkedin.com/company/xxx or linkedin.com/school/xxx
4. Return the most official/verified page if multiple exist
5. If the organization has multiple entities, return the main/parent one

EXAMPLES of what to return:
- For \"Stanford University\" → https://www.linkedin.com/school/stanford-university
- For \"Google\" → https://www.linkedin.com/company/google
- For \"MIT\" → https://www.linkedin.com/school/massachusetts-institute-of-technology

RESPONSE FORMAT:
If found, respond with ONLY the LinkedIn URL on a single line:
https://www.linkedin.com/company/company-name
OR
https://www.linkedin.com/school/school-name

If NOT found or only department pages exist, respond with exactly:
NOT_FOUND"

PERSON_PROFILE_SEARCH_PROMPT="Find the LinkedIn profile for this specific person:

{person_context}

TASK: Search for the LinkedIn personal profile page for this individual.

CRITICAL MATCHING RULES:
1. Find a linkedin.com/in/username profile URL for THIS SPECIFIC PERSON
2. The person MUST work at or be affiliated with {company}
3. ALL available context (position, department, location) should match
4. Be VERY careful with common names - require multiple matching attributes
5. Do NOT return company pages (linkedin.com/company/...)
6. Do NOT return school pages (linkedin.com/school/...)
7. Only return a profile if you're HIGHLY CONFIDENT it's the right person
{matching_guidance}

CONTRADICTION DETECTION - REJECT if ANY of these are true:
- Profile shows a completely DIFFERENT field of work (e.g., real estate agent when expecting researcher)
- Profile shows a conflicting location (e.g., India when expecting USA, unless recent move indicated)
- Profile shows unrelated industry (e.g., hospitality, retail when expecting engineering/science)
- Profile title/role is fundamentally incompatible (e.g., \"Marketing Manager\" when expecting \"Professor\")
- Same name but clearly different person (different photo context, different career entirely)

VERIFICATION CHECKLIST:
- Name matches (including possible variations like Dr., Prof.)
- Organization/company affiliation matches
- Job title/position is consistent with the context
- Location is consistent (if provided)
- Department or field aligns (if provided)
- NO contradictory information present

RESPONSE FORMAT:
If you find their LinkedIn profile with HIGH CONFIDENCE, respond with ONLY the URL like:
https://www.linkedin.com/in/username

If you cannot find their personal LinkedIn profile OR are uncertain OR found contradictory information, respond exactly:
NOT_FOUND"

DEPARTMENT_SEARCH_PROMPT="Find the LinkedIn company/school page for this specific department, faculty, or school:

Department/Faculty: {department}
Parent Organization: {parent_org}
{parent_slug_line}

TASK: Search for a LinkedIn page that is specifically for this department, faculty, or school unit - NOT the main parent organization.

SEARCH EXAMPLES:
- \"UCL Biochemical Engineering\" might have linkedin.com/school/ucl-biochemical-engineering
- \"MIT Sloan\" might have linkedin.com/school/mit-sloan
- \"Stanford Graduate School of Business\" might have linkedin.com/school/stanford-gsb

IMPORTANT:
- Many university departments have their own LinkedIn pages
- Look for pages with names like \"{parent_org} {department}\" or \"{department} at {parent_org}\"
- The URL format is linkedin.com/company/xxx or linkedin.com/school/xxx
- Do NOT return the main parent organization page (e.g., don't return UCL main page)
- The page name should specifically reference the department or faculty

RESPONSE:
If you find a department-specific LinkedIn page, respond with ONLY the full URL, like:
https://www.linkedin.com/school/ucl-biochemical-engineering

If you cannot find a department-specific page (only the parent org exists), respond with exactly:
NOT_FOUND"

IMAGE_ANALYSIS_PROMPT="Analyze this image from a technical/engineering news article.
Describe in 2-3 sentences:
1. What specific equipment, technology, or facility is shown (be precise - e.g., \"PEM electrolyzer stack\", \"distillation column\", \"CRISPR gene editing setup\")
2. The setting/environment (laboratory, industrial plant, pilot facility, control room, etc.)
3. Any distinctive visual elements (colors, scale, materials, instrumentation)

Focus on technical accuracy. Be specific about equipment types, not generic.
If this appears to be a stock photo or generic image, say \"GENERIC STOCK IMAGE\".
Keep response under 100 words."

ALT_TEXT_PROMPT="Generate a concise alt text description (1-2 sentences, max 150 characters) for an image.

The image was generated for this story:
Title: {story_title}
Summary: {story_summary}

The image depicts: {image_prompt}

Write alt text that:
1. Describes what's shown in the image for visually impaired users
2. Is concise but informative (aim for 80-150 characters)
3. Focuses on the main subject and setting
4. Does NOT start with \"Image of\" or \"Picture of\"
5. Does NOT include hashtags or promotional content

Return ONLY the alt text, nothing else."

IMAGE_FALLBACK_NO_HUMAN_PROMPT="A photo of industrial/scientific equipment and technology related to: {story_title}. Focus on machinery, facilities, processes, or environments relevant to {discipline}. No people as the central subject. Wide shot showing the technology or environment. Professional documentary photography, editorial quality for a trade publication."

NO_HUMAN_INSTRUCTION="IMPORTANT: NO CENTRAL HUMAN CHARACTER IN THIS IMAGE.
Focus on illustrating the story through:
- Technology, equipment, machinery, or scientific apparatus relevant to the story
- Environments, facilities, or locations described in the story
- Abstract concepts, data visualizations, or process diagrams
- Natural phenomena, materials, or products being discussed

If people appear in the image, they MUST be:
- Incidental and peripheral to the main subject (e.g., small figures in background)
- Part of a crowd or group scene where no individual is the focus
- Silhouettes or partially visible, not the main subject

The image should focus on the SUBJECT MATTER of the story, not on any individual person.
Do NOT include: close-up portraits, waist-up shots of individuals, or any person as the central figure."

HUMAN_APPEARANCE_INSTRUCTION="MANDATORY APPEARANCE FOR THIS IMAGE (use exactly as specified):
    The female {discipline} professional in this image must be: {random_appearance}.
Do NOT deviate from this appearance description. Include these exact physical traits in your prompt."

DIRECT_PEOPLE_EXTRACTION_PROMPT="You are extracting people explicitly mentioned in a news story. Your goal is to provide DETAILED information that enables accurate LinkedIn profile matching.

Story title: {story_title}
Story summary: {story_summary}
Story sources: {sources_str}

Return STRICT JSON with this shape:
{{
  \"direct_people\": [
    {{
      \"name\": \"Full Name (First Last format)\",
      \"job_title\": \"Exact title as mentioned (e.g., 'Senior Research Scientist', 'CEO', 'Professor')\",
      \"employer\": \"Company/Institution name (official name, not abbreviation)\",
      \"department\": \"Department, Division, or Lab name if mentioned\",
      \"location\": \"City, State/Country if mentioned\",
      \"specialty\": \"Field of expertise, research area, or domain\",
      \"credentials\": \"PhD, Dr., Prof., etc. if mentioned\",
      \"role_in_story\": \"primary|quoted|mentioned\",
      \"context_clues\": \"Any other identifying details (e.g., 'co-author', 'led the study', 'announced at conference')\"
    }}
  ],
  \"organizations\": [\"Official Organization Name\", ...]
}}

EXTRACTION RULES:
1. Include ONLY people explicitly named BY NAME in the story content. If no individuals are named, return an EMPTY \"direct_people\" list
2. NEVER use the article title, headline, or topic as a person's name
3. Use FULL official organization names (e.g., \"Massachusetts Institute of Technology\" not \"MIT\")
4. Extract department/lab names when available (e.g., \"Department of Chemical Engineering\")
5. Include location details for disambiguation (multiple people may share names)
6. Capture credentials like \"Dr.\", \"Professor\", \"PhD\" when present
7. For \"role_in_story\":
   - \"primary\": Main subject of the story or lead researcher
   - \"quoted\": Directly quoted in the story
   - \"mentioned\": Referenced but not quoted
8. Keep strings concise; no markdown, no additional text beyond the JSON
9. If any field is not available, use empty string \"\"
10. NEVER use the same word for first AND last name (e.g., don't create \"Srinivasan Srinivasan\")
11. For single-name mentions, try to find the full name from context, or use the single name only
12. Do NOT include organization names (universities, companies, institutes) as person names
13. Do NOT include article titles, topics, or technology names as person names"

SOURCE_PEOPLE_SEARCH_PROMPT="Find all people mentioned in this news story by searching the source URL.

STORY TITLE: {story_title}

STORY SUMMARY: {story_summary}

SOURCE URL TO SEARCH: {sources_str}

TASK: Search the source URL and extract:
1. All researchers, scientists, professors named in the article
2. Any executives, leaders, or spokespersons quoted
3. Authors of the study if it's research
4. Anyone receiving awards or honors

Look for:
- Names in quotes (people who said something)
- Names linked to profile pages
- Names in bylines or \"about the author\" sections
- Names in research paper citations
- \"Senior author\", \"lead researcher\", \"principal investigator\" mentions

Return a JSON object:
{{
  \"organizations\": [\"Org Name 1\", \"Org Name 2\"],
  \"direct_people\": [
    {{\"name\": \"Full Name\", \"title\": \"Their Title/Role\", \"affiliation\": \"Their Institution\"}}
  ]
}}

If nothing found, return: {{\"organizations\": [], \"direct_people\": []}}

Return ONLY valid JSON, no explanation."

ORIGINALITY_ANALYSIS_PROMPT="Analyze the originality of this summary compared to the source text.

SUMMARY:
{summary}

SOURCE EXCERPT:
{source}

EVALUATE:
1. Is the summary sufficiently paraphrased (not just rearranged words)?
2. Does it add unique perspective or insight beyond the source?
3. Are there any phrases copied verbatim that should be quoted or rephrased?
4. Would this pass academic plagiarism standards?

Respond in this exact format:
ORIGINAL: YES or NO
CONFIDENCE: 0.0-1.0
ISSUES: [comma-separated list or \"none\"]
RECOMMENDATION: [one sentence]"

RAG_PERSONALIZATION_PROMPT="AUTHOR'S PROFESSIONAL CONTEXT:
{context}

STORY TO PERSONALIZE:
Title: {title}
Summary: {summary}

INSTRUCTIONS:
{base_prompt}

When writing, naturally connect the story to the author's experience where relevant.
Reference specific skills, projects, or achievements that relate to the topic.
Maintain authenticity - only reference experiences that genuinely connect to the story."

RAG_BASE_PROMPT="STORY:
Title: {title}
Summary: {summary}

INSTRUCTIONS:
{base_prompt}"
